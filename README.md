# UART-FourServoControllBoard

## 概要 (Overview)

**UART-FourServoControllBoard** (以下UART-FSCB) は、わずか **23.45mm x 23.95mm** のサイズに、ロボットアーム制御に必要な機能をおおよそ詰め込んだ4軸スマートサーボコントローラです。
従来のPCA9685モジュール等の単なるPWMドライバとは異なり、**電流・電圧測定**、**USB-PD** 機能を搭載。MG996Rなどのハイパワーサーボ使用時でも、電流値と消費電力を監視しながら安全に駆動することが可能です。

## 特徴 (Features)

* **超小型サイズ:** 23.45mm x 23.95mm
* **USB PD対応:** CCピン制御により、モバイルバッテリーやPD充電器から5V/3Aを直接引き出し可能。
  * 通信をUSB経由で可能。
  * 書き込みをUSB経由で可能（別途コマンド必須）。
* **電流監視機能:**
  * ローサイド電流検知回路を搭載（CH32X035内蔵OPA + 20mΩシャント抵抗）。
  * サーボの負荷状態をモニタリングし、過負荷時の緊急停止などが実装可能。
* **電源安定化:**
  * **100uF 高分子アルミ電解コンデンサ** を実装。
* **電圧監視機能**
  * 分圧抵抗によって電圧を監視可能。
* **プロッティング**
  * Goによるスクリプトによってパラメータの制御やプロッティング、プログラム書き込みなどが可能になる予定。
* **MCU:** WCH CH32X035F7P6 (RISC-V, 48MHz)
* **制御IF:** UART, USB
* **その他:**
  * 外部電源入出力ピン（バッテリー駆動対応）
  * デバック用ピン
  * 片面実装
  * 手ハンダ可能
  * XC6206 LDOによる安定した3.3V系電源

## 仕様 (Specifications)

| 項目 | 内容 |
| :--- | :--- |
| **MCU** | WCH CH32X035F7P6 (TSSOP-20) |
| **入力電圧** | USB VBUS (5V-20V) または EXT_IN (5V〜20V) |
| **ロジック電圧** | 3.3V (XC6206 LDO内蔵) |
| **出力チャンネル** | 4PWM |
| **通信** | UART (Default: 115200bps, 8N1) |
| **電流検知** | 0 〜 6.8A (Full Scale) |
| **コンデンサ** | 100uF / 35V (Polymer) + 22uF (Ceramic) |
| **基板サイズ** | 23.45mm x 23.95mm |

## 部品表 (BOM)

| 名称 | 最低購入量 | 購入価格 | 単価 | 必要量 | 購入先 | 備考 |
| :--- | ---: | ---: | ---: | ---: | :--- | :--- |
| CH32X035F7P6 | 10 | 632 | 63.2 | 1 | ali | MCU |
| XC6203P332MR | 100 | 336 | 3.36 | 1 | ali | LDO |
| Type-C 16P Conn | 10 | 318 | 31.8 | 1 | ali | USB-PD |
| 0603 LED Red | 20 | 72.4 | 3.6 | 2 | ali | 状態表示 |
| 高分子コンデンサ 35V/100uF | 20 | 288 | 14.4 | 1 | ali | 電源用 |
| 0603 積セラ 10V/22uF | 50 | 320 | 6.4 | 1 | ali | MCU用 |
| 0603 積セラ 50V/100nF | 100 | 260 | 2.6 | 2 | ali | パスコン |
| 1206 20mΩ 1W | 20 | 454 | 22.7 | 1 | ali | 電流センス抵抗 |
| 0603 22Ω 1/10W | 100 | 361 | 3.6 | 2 | ali | DP_DM用 |
| 0603 1kΩ 1/10W | 100 | 356 | 3.6 | 4 | ali | TX_RX_LED兼用 |
| 0603 5.1kΩ 1/10W | 100 | 360 | 3.6 | 4 | ali | CC_Amp入力兼用 |
| 0603 120kΩ 1/10W | 100 | 349 | 3.5 | 2 | ali | 増幅回路 |
| プリント基板 | 80 | 1165 | 14.56 | 1 | JLCPCB | 4x4面付け、送料別 |
| 合計 | 810 | 5271.4 | 211.82 | 23 | - | 単価は1枚当たりの原価 |

## 開発環境 (Development)

* **IDE:** PlatformIO
* **Framework:** ch32fun
* **Writer:** WCH-LinkE

## 設計データ (Design Data)

* **EDA:** KiCad 9.0
* **PCB:** 2層基板 (1.6mm厚推奨)
